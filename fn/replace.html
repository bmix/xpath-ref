<!DOCTYPE html><html xmlns="http://www.w3.org/1999/xhtml" itemscope="itemscope" itemtype="http://schema.org/WebPage">
   <head>
      <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
      <meta name="viewport" content="width=device-width,initial-scale=1.0" />
      <title>fn:replace</title>
      <link rel="stylesheet" href="../bootstrap/dist/css/bootstrap.min.css" />
      <link rel="stylesheet" href="../css/site.css" />
      <link rel="shortcut icon" href="../favicon.ico" />
   </head>
   <body>
      <header role="navigation">
         <nav class="container">
            <div class="col-md-9 breadcrumb-col">
               <ol class="breadcrumb" itemprop="breadcrumb">
                  <li><a href="../">XPath Reference</a></li>
                  <li class="active">fn:replace</li>
               </ol>
            </div>
            <div class="col-md-3 search-col">
               <form method="get" action="https://cse.google.com/cse"><input type="hidden" name="cx" value="012329136009221431645:sv1eakamyny" /><div class="input-group"><input type="search" name="q" class="form-control" placeholder="Search" /><span class="input-group-btn"><button class="btn btn-default" type="button"><i class="glyphicon glyphicon-search"></i></button></span></div>
               </form>
            </div>
         </nav>
      </header>
      <article class="container" itemscope="itemscope" itemtype="http://schema.org/WebPageElement" itemprop="mainContentOfPage">
         <header>
            <h1 class="page-header">fn:replace</h1>
         </header>
         <p>Returns a string produced from the input string by replacing any substrings that match
            a
            given regular expression with a supplied replacement string.
         </p>
         <section>
            <header>
               <h2>Signatures</h2>
            </header><pre><code class="signature"><span class="function">fn:replace</span><span class="parenthesis">(</span><span class="whitespace">&#xD;
    </span><span class="variable">$input</span><span class="whitespace"> </span><span class="op">as</span><span class="whitespace"> </span><span class="type-name">xs:string</span><span class="quantifier">?</span><span class="op">,</span><span class="whitespace"> &#xD;
    </span><span class="variable">$pattern</span><span class="whitespace"> </span><span class="op">as</span><span class="whitespace"> </span><span class="type-name">xs:string</span><span class="op">,</span><span class="whitespace"> &#xD;
    </span><span class="variable">$replacement</span><span class="whitespace"> </span><span class="op">as</span><span class="whitespace"> </span><span class="type-name">xs:string</span><span class="whitespace">&#xD;
</span><span class="parenthesis">)</span><span class="whitespace"> </span><span class="op">as</span><span class="whitespace"> </span><span class="type-name">xs:string</span></code></pre><pre><code class="signature"><span class="function">fn:replace</span><span class="parenthesis">(</span><span class="whitespace">&#xD;
    </span><span class="variable">$input</span><span class="whitespace"> </span><span class="op">as</span><span class="whitespace"> </span><span class="type-name">xs:string</span><span class="quantifier">?</span><span class="op">,</span><span class="whitespace"> &#xD;
    </span><span class="variable">$pattern</span><span class="whitespace"> </span><span class="op">as</span><span class="whitespace"> </span><span class="type-name">xs:string</span><span class="op">,</span><span class="whitespace"> &#xD;
    </span><span class="variable">$replacement</span><span class="whitespace"> </span><span class="op">as</span><span class="whitespace"> </span><span class="type-name">xs:string</span><span class="op">,</span><span class="whitespace"> &#xD;
    </span><span class="variable">$flags</span><span class="whitespace"> </span><span class="op">as</span><span class="whitespace"> </span><span class="type-name">xs:string</span><span class="whitespace">&#xD;
</span><span class="parenthesis">)</span><span class="whitespace"> </span><span class="op">as</span><span class="whitespace"> </span><span class="type-name">xs:string</span></code></pre></section>
         <section>
            <header>
               <h2>Properties</h2>
            </header>
            <p>This function is <a href="https://www.w3.org/TR/xpath-functions-31/#dt-deterministic">deterministic</a>, <a href="https://www.w3.org/TR/xpath-functions-31/#dt-context-independent">context-independent</a>,  and <a href="https://www.w3.org/TR/xpath-functions-31/#dt-focus-independent">focus-independent</a>. 
            </p>
         </section>
         <section>
            <header>
               <h2>Rules</h2>
            </header>
            <p>The effect of calling the first version of this function (omitting the argument
               <code>$flags</code>) is the same as the effect of calling the second version with the
               <code>$flags</code> argument set to a zero-length string. Flags are defined in
               <a href="https://www.w3.org/TR/xpath-functions-31/#flags">Flags</a>.
            </p>
            <p>The <code>$flags</code> argument is interpreted in the same manner as for the
               <code>fn:matches</code> function. 
            </p>
            <p>If <code>$input</code> is the empty sequence, it is interpreted as the zero-length
               string.
            </p>
            <p>The function returns the <code>xs:string</code> that is obtained by replacing each
               non-overlapping substring of <code>$input</code> that matches the given
               <code>$pattern</code> with an occurrence of the <code>$replacement</code> string.
            </p>
            <p>If two overlapping substrings of <code>$input</code> both match the
               <code>$pattern</code>, then only the first one (that is, the one whose first <a href="https://www.w3.org/TR/xpath-functions-31/#character">character</a> comes first in the <code>$input</code> string) is
               replaced.
            </p>
            <p>If the <code>q</code> flag is present, the replacement string is used as
               is.
            </p>
            <p>Otherwise, within the <code>$replacement</code> string, a variable <code>$N</code> may
               be used to refer to the substring captured by the Nth parenthesized sub-expression
               in
               the regular expression. For each match of the pattern, these variables are assigned
               the
               value of the content matched by the relevant sub-expression, and the modified
               replacement string is then substituted for the <a href="https://www.w3.org/TR/xpath-functions-31/#character">characters</a> in <code>$input</code> that matched the pattern.
               <code>$0</code> refers to the substring captured by the regular expression as a
               whole.
            </p>
            <p>More specifically, the rules are as follows, where <code>S</code> is the number of
               parenthesized sub-expressions in the regular expression, and <code>N</code> is the
               decimal number formed by taking all the digits that consecutively follow the
               <code>$</code> character:
            </p>
            <ol>
               <li>
                  <p>If <code>N</code>=<code>0</code>, then the variable is replaced by the substring
                     matched by the regular expression as a whole.
                  </p>
               </li>
               <li>
                  <p>If <code>1</code>&lt;=<code>N</code>&lt;=<code>S</code>, then the variable is
                     replaced by the substring captured by the Nth parenthesized sub-expression. If the
                     <code>Nth</code> parenthesized sub-expression was not matched, then the
                     variable is replaced by the zero-length string.
                  </p>
               </li>
               <li>
                  <p>If <code>S</code>&lt;<code>N</code>&lt;=<code>9</code>, then the variable is
                     replaced by the zero-length string.
                  </p>
               </li>
               <li>
                  <p>Otherwise (if <code>N</code>&gt;<code>S</code> and
                     <code>N</code>&gt;<code>9</code>), the last digit of <code>N</code> is taken to
                     be a literal character to be included "as is" in the replacement string, and the
                     rules are reapplied using the number <code>N</code> formed by stripping off this
                     last digit.
                  </p>
               </li>
            </ol>
            <p>For example, if the replacement string is 
               <code>"$23"</code>
               and there are 5 substrings, the result contains the value of the substring that
               matches the second sub-expression, followed by the digit 
               <code>3</code>.
            </p>
            <p>Unless the <code>q</code> flag is used, a literal <code>$</code> character within the
               replacement string must be written as <code>\$</code>, and a literal <code>\</code>
               character must be written as <code>\\</code>.
            </p>
            <p> If two alternatives within the pattern both match at the same position in the
               <code>$input</code>, then the match that is chosen is the one matched by the first
               alternative. For example:
            </p><pre><code><span class="function">fn:replace</span><span class="parenthesis">(</span><span class="op">"</span><span class="literal">abcd</span><span class="op">"</span><span class="op">,</span><span class="whitespace"> </span><span class="op">"</span><span class="literal">(ab)|(a)</span><span class="op">"</span><span class="op">,</span><span class="whitespace"> </span><span class="op">"</span><span class="literal">[1=$1][2=$2]</span><span class="op">"</span><span class="parenthesis">)</span><span class="whitespace"> </span><span class="qname">returns</span><span class="whitespace"> </span><span class="op">"</span><span class="literal">[1=ab][2=]cd</span><span class="op">"</span></code></pre></section>
         <section>
            <header>
               <h2>Error Conditions</h2>
            </header>
            <p>A dynamic error is raised [<a href="https://www.w3.org/TR/xpath-functions-31/#ERRFORX0002">ERRFORX0002</a>] if the value of
               <code>$pattern</code> is invalid according to the rules described in section <a href="https://www.w3.org/TR/xpath-functions-31/#regex-syntax">Regular expression syntax</a>. 
            </p>
            <p>A dynamic error is raised [<a href="https://www.w3.org/TR/xpath-functions-31/#ERRFORX0001">ERRFORX0001</a>] if the value of
               <code>$flags</code> is invalid according to the rules described in section <a href="https://www.w3.org/TR/xpath-functions-31/#flags">Flags</a>. 
            </p>
            <p>A dynamic error is raised [<a href="https://www.w3.org/TR/xpath-functions-31/#ERRFORX0003">ERRFORX0003</a>] if the pattern matches a
               zero-length string, that is, if the expression <code>fn:matches("", $pattern,
                  $flags)</code> returns <code>true</code>. It is not an error, however, if a captured
               substring is zero-length.
            </p>
            <p>In the absence of the <code>q</code> flag,
               a dynamic error is raised [<a href="https://www.w3.org/TR/xpath-functions-31/#ERRFORX0004">ERRFORX0004</a>] if the value of
               <code>$replacement</code> contains a dollar sign (<code>$</code>) character that is not
               immediately followed by a digit <code>0-9</code> and not immediately preceded by a
               backslash (<code>\</code>).
            </p>
            <p>In the absence of the <code>q</code> flag,
               a dynamic error is raised [<a href="https://www.w3.org/TR/xpath-functions-31/#ERRFORX0004">ERRFORX0004</a>] if the value of
               <code>$replacement</code> contains a backslash (<code>\</code>) character that is not part of a
               <code>\\</code> pair, unless it is immediately followed by a dollar sign (<code>$</code>)
               character.
            </p>
         </section>
         <section>
            <header>
               <h2>Notes</h2>
            </header>
            <p>If the input string contains no substring that matches the regular
               expression, the result of the function is a single string identical to the input
               string.
            </p>
         </section>
         <section>
            <header>
               <h2>Examples</h2>
            </header>
            <p>The expression <code>fn:replace("abracadabra", "bra", "*")</code> returns <code>"a*cada*"</code>.
            </p>
            <p>The expression <code>fn:replace("abracadabra", "a.*a", "*")</code> returns <code>"*"</code>.
            </p>
            <p>The expression <code>fn:replace("abracadabra", "a.*?a", "*")</code> returns <code>"*c*bra"</code>.
            </p>
            <p>The expression <code>fn:replace("abracadabra", "a", "")</code> returns <code>"brcdbr"</code>.
            </p>
            <p>The expression <code>fn:replace("abracadabra", "a(.)", "a$1$1")</code> returns <code>"abbraccaddabbra"</code>.
            </p>
            <p>The expression <code>fn:replace("abracadabra", ".*?", "$1")</code> raises an error,
               because the pattern matches the zero-length string 
            </p>
            <p>The expression <code>fn:replace("AAAA", "A+", "b")</code> returns <code>"b"</code>.
            </p>
            <p>The expression <code>fn:replace("AAAA", "A+?", "b")</code> returns <code>"bbbb"</code>.
            </p>
            <p>The expression <code>fn:replace("darted", "^(.*?)d(.*)$", "$1c$2")</code> returns <code>"carted"</code>. (The first <code>d</code> is replaced.)
            </p>
         </section>
         <footer>
            <h2>See Also</h2>
            <ul>
               <li><a href="https://www.w3.org/TR/xpath-functions-31/#func-replace">XPath 3.1 Functions and Operators</a></li>
               <li><a href="http://www.w3.org/TR/xpath-functions-30/#func-replace">XPath 3.0 Functions and Operators</a></li>
               <li><a href="http://www.w3.org/TR/xpath-functions/#func-replace">XPath 2.0 Functions and Operators</a></li>
               <li><a href="http://www.saxonica.com/html/documentation/functions/fn/replace.html">Saxon Function Library</a></li>
            </ul>
         </footer>
      </article>
      <footer>
         <div class="container"><small class="copyright">Portions of this document were copied from <a href="https://www.w3.org/TR/2017/REC-xpath-functions-31-20170321/xpath-functions-31.xml">this file</a>, <a href="http://www.w3.org/Consortium/Legal/ipr-notice#Copyright">Copyright</a>&nbsp;©&nbsp;2017&nbsp;<a href="http://www.w3.org/"><acronym title="World Wide Web Consortium">W3C</acronym></a><sup>®</sup> (<a href="http://www.csail.mit.edu/"><acronym title="Massachusetts Institute of Technology">MIT</acronym></a>, <a href="http://www.ercim.eu/"><acronym title="European Research Consortium for Informatics and Mathematics">ERCIM</acronym></a>, <a href="http://www.keio.ac.jp/">Keio</a>, <a href="http://ev.buaa.edu.cn/">Beihang</a>), All Rights Reserved.</small></div>
      </footer>
   </body>
</html>